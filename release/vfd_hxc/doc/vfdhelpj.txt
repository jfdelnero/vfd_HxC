
  VFD.EXE Command Reference


====================
      GENERAL
====================

構文：
  VFD.EXE [コマンド [オプション...]]

コマンド：
  INSTALL   ドライバをインストールします。
  REMOVE    ドライバをアンインストールします。
  CONFIG    ドライバの設定を変更します。
  START     ドライバを開始します。
  STOP      ドライバを停止します。
  SHELL     シェルエクステンションを有効／無効にします。
  OPEN      イメージをオープンします。
  CLOSE     現在のイメージをクローズします。
  SAVE      現在のイメージをファイルに保存します。
  PROTECT   ドライブの書き込み保護を有効／無効にします。
  FORMAT    現在の仮想メディアをフォーマットします。
  LINK      ドライブにドライブ文字を割り当てます。
  ULINK     ドライブのドライブ文字を削除します。
  STATUS    現在の状態を表示します。
  HELP | ?  使用方法を表示します。
  VERSION   バージョン情報を表示します。

コマンドを指定しない場合、対話式コンソールを起動します。
対話式コンソールの詳細は 'VFD.EXE HELP CONSOLE' を参照してください。

コマンドおよびオプションの大文字、小文字は区別されません。

コマンドを一意に判別できる範囲でコマンド名を短縮することができます。
I (INSTALL), REM (REMOVE) などは使用可能ですが、ST はあいまいなため
使用できません。この場合は STAR, STO, STAT まで入力しないと区別でき
ません。

'VFD.EXE コマンド {/? | /h}' で各コマンドの簡単な説明を表示します。


====================
      CONSOLE
====================

対話式コンソールでは、通常の VFD コマンドに加えて以下のコマンドが使用
できます。

  CD | CHDIR
            現在のディレクトリを変更したり、ディレクトリ名を表示したり
            します。Windows 標準の CD/CHDIR コマンドに類似の機能です。

  <ドライブ>:
            現在のディレクトリを指定ドライブのルートに変更します。
            Windows 標準のドライブ変更コマンドに類似の機能です。

  DIR       Windows 標準の DIR コマンドを実行します。
            標準コマンドのオプションは全て使用可能です。

  ATTRIB    Windows 標準の ATTRIB コマンドを実行します。
            標準コマンドのオプションは全て使用可能です。

  EXIT | QUIT | BYE | <Ctrl+C>
            VFD 対話式コンソールを終了します。

先頭に '.'(ピリオド)を付けて入力したコマンドは、Windows のコマンド
プロセッサ(cmd.exe)で実行されます。

  例）.FORMAT [オプション ...]
        Windows 標準の format.exe を実行します。指定したオプションは
        全て format.exe に渡されます。

      FORMAT [オプション ...]
        VFD コンソールの FORMAT コマンドを実行します。

スペースを含む外部コマンドを実行する場合、'.'(ピリオド)は引用符の外に
記述します。

  例) ."C:\Program Files\My App\My Program.exe" [オプション ...]

DIR および ATTRIB Windows 標準コマンドは頻繁に使用するため、ピリオド
なしでも使用できます。

環境変数またはカレントディレクトリを変更するようなコマンドはコマンド
プロセッサの内部でのみ効果を持ちます。ピリオドをつけて実行することは
できますが VFD コンソールには効果がありません：

  .CD .CHDIR <ドライブ>: でカレントディレクトリを変更する
  .PUSHD/.POPD
  .PATH で検索パスを変更する
  .PROMPT
  .SET で環境変数の値を変更する


====================
      INSTALL
====================

仮想フロッピドライバをインストールします。

構文：
  VFD.EXE INSTALL [ドライバ] [/AUTO | /A]

オプション：
  ドライバ  仮想フロッピドライバのパスを指定します。
            省略時は VFD コンソールプログラムと同じディレクトリにある
            VFD.SYS です（カレントディレクトリではありません）。

  /AUTO     仮想フロッピドライバをシステム起動時に自動で開始するよう
  /A        設定します（インストール直後に自動で開始されるのではあり
            ません）。
            省略した場合は必要に応じて手動で開始しなければなりません。

デバイスドライバのインストールには Administrator 権限が必要です。

デバイスドライバはネットワークドライブからインストールすることができ
ません。VFD.SYS ファイルは必ずローカルドライブに置いてください。

Administrator や Power User 以外の、デバイスドライバの開始権限を持た
ないユーザで仮想フロッピドライブを使用する場合には /AUTO オプションを
付けてインストールしておくと良いでしょう。


====================
       REMOVE
====================

仮想フロッピドライバをアンインストールします。

構文：
  VFD.EXE REMOVE [/FORCE | /F | /QUIT | /Q]

オプション：
  /FORCE    ドライバが停止できない場合、ユーザに確認を要求せずにアン
  /F        インストール処理を続行します。

  /QUIT     ドライバが停止できない場合、ユーザに確認を要求せずにアン
  /Q        インストール処理を中止します。

必要に応じてイメージのクローズとドライバの停止を行い、システムから
仮想フロッピドライバのエントリを削除します。

ドライバファイル自体をローカルディスクから削除はしません。

システムの状態によってはアンインストールが即座に完了せず、システムの
再起動が必要となる場合があります。その場合、システムを再起動してアン
インストールが完了するまで 仮想フロッピドライバを再びインストールする
ことはできません。

デバイスドライバのアンインストールには Administrator 権限が必要です。


====================
       CONFIG
====================

仮想フロッピドライバの起動方法を設定します。

構文：
  VFD.EXE CONFIG {/AUTO | /A | /MANUAL | /M}

オプション：
  /AUTO     仮想フロッピドライバをシステム起動時に自動で開始するよう
  /A        設定します（インストール直後に自動で開始されるのではあり

  /MANUAL   仮想フロッピドライバを必要に応じて手動で起動するよう設定
  /M        します。

変更は次回システム起動時から有効になります。
デバイスドライバの設定には Administrator 権限が必要です。


====================
       START
====================

仮想フロッピドライバを起動します。

構文：
  VFD.EXE START

オプション：
  なし

ドライバがインストールされていない場合、デフォルトオプションでのイン
ストールを試みます。

デバイスドライバの開始には Power User 以上の権限が必要です。


====================
        STOP
====================

仮想フロッピドライバを停止します。

構文：
  VFD.EXE STOP [/FORCE | /F | /QUIT | /Q]

オプション：
  /FORCE    使用中でクローズできないドライブがある場合に、ユーザ確認
  /F        を要求せずに停止処理を続行します。

  /QUIT     使用中でクローズできないドライブがある場合に、ユーザ確認
  /Q        を要求せずに停止処理を中止します。

オープン中のイメージを全てクローズしてからドライバを停止します。
仮想ドライブが他のプログラムから使用されているとイメージをクローズ
することができません。使用中のドライブがあるときに停止処理を強制する
と、ドライバが「停止予約」状態になることがあります。このような場合、
ドライバが完全に停止状態になるまで再起動ができません。

デバイスドライバの停止には Power User 以上の権限が必要です。


====================
       SHELL
====================

仮想フロッピドライブシェルエクステンションを有効／無効にします。

構文：
  VFD.EXE SHELL [/ON | /OFF]

オプション：
  /ON       シェルエクステンションを有効にします。

  /OFF      シェルエクステンションを無効にします。

オプション指定しない場合、現在の状態を表示します。


====================
        OPEN
====================

仮想フロッピイメージをオープンします。

構文：
  VFD.EXE OPEN [ドライブ:] [ファイル] [/NEW] [/RAM] [/P | /W]
        [/サイズ] [/メディア] [/F | /FORCE | /Q | /QUIT]

オプション：
  ドライブ: 対象ドライブをドライブ番号またはドライブ文字で指定します。
            "0:", "1:", "B:", "X:" のように ':' は必須です。
            省略した場合ドライブ 0 が使用されます。

  ファイル  フロッピイメージファイルを指定します。
            省略した場合、空の RAM ディスクが作成されます。

  /NEW      新規イメージファイルを作成します。
            ファイルが指定されていない場合無視されます。

  /RAM      RAM モード - メモリ上にファイルのコピーを作成してマウント
            します。ディスクに加えた変更は、'SAVE' コマンドで明示的に
            ファイルに保存しない限り、イメージをクローズするときに失
            われます。
            ファイルが指定されていない場合無視されます。

  /P        イメージを書き込み保護メディアとしてオープンします。
            書き込み保護状態は、'PROTECT' コマンドを使用して後で変更
            することができます。

  /W        イメージを書き込み可能メディアとしてオープンします。
            書き込み保護状態は、'PROTECT' コマンドを使用して後で変更
            することができます。

  /size     仮想メディアのサイズを指定します。
            以下のオプションが使用できます:

              /160 (160KB)    /820 (820KB)
              /180 (180KB)    /120 or /1.20 (1.20MB)
              /320 (320KB)    /144 or /1.44 (1.44MB)
              /360 (360KB)    /168 or /1.68 (1.68MB DMF)
              /640 (640KB)    /172 or /1.72 (1.72MB DMF)
              /720 (720KB)    /288 or /2.88 (2.88MB)

  /5        5.25 インチメディアを指定します。640KB、720KB および
  /525      1.2MB メディアの場合のみ効果をもち、それ以外の場合は指定
  /5.25     しても無視します。
            160KB, 180KB, 320KB および 360KB メディアは常に 5.25 イン
            チです
            820KB, 1.44MB, 1.68MB, 1.72MB および 2.88MB は常に 3.5 イ
            ンチです。

  /FORCE    オプションの衝突や必要なオプションが省略されていた場合に
  /F        ユーザ確認を要求せずに、必要に応じてデフォルト値を使用し
            たりして可能な限り処理を続行します。
            詳細は下記を参照してください。
            
  /QUIT     オプションの衝突や必要なオプションが省略されていた場合に
  /Q        ユーザ確認を要求せずに、即座に処理を中止します。
            詳細は下記を参照してください。

対象ドライブにドライブ文字が割り当てられていない場合、最初の使用可能
な文字を使用してローカルドライブ文字（'VFD.EXE HELP LINK' 参照）を
割り当てます。

読み取り専用ファイル、NTFS 暗号化／圧縮ファイル、ZIP 圧縮イメージファ
イル（WinImage IMZ ファイルなど）は直接マウントできないため、必ず RAM
モードモードでオープンしなければなりません。

サイズ指定オプションがない場合、仮想メディアサイズは実際のイメージサ
イズを元に選択されます。明示的にサイズを指定して、実際のイメージより
小さなメディアを選択することも出来ます。この場合、イメージ後半の余分
なデータ領域は無視されます。
実際のイメージサイズを超えるメディアを選択することはできません。

/F オプションおよび /Q オプションによる OPEN コマンドの動作：

  対象ファイルが存在せず、/NEW オプションが指定されていない場合

    (なし) ファイルを作成するかどうかをユーザに確認する
      /F   確認せずにファイルを新規作成する
      /Q   確認せずに処理を中止する

  対象ファイルが存在し、/NEW オプションが指定されている場合

    (なし) 既存ファイルを上書きするかどうかをユーザに確認する
      /F   確認せずにファイルを上書きする
      /Q   確認せずに処理を中止する

  対象ファイルが直接マウントできない種類で、/RAM オプションが
  指定されていない場合

    (なし) RAM モードで開くかどうかをユーザに確認する
      /F   確認せずに RAM モードで開く
      /Q   確認せずに処理を中止する

  新規イメージ作成時に、サイズオプションが指定されていない場合

    (なし) デフォルトの 1.44MB イメージを作成するかどうかを
           ユーザに確認する
      /F   確認せずに 1.44MB イメージを作成する
      /Q   確認せずに処理を中止する

  サイズオプションが指定されておらず、対象ファイルのサイズと
  正確に一致するメディアがない場合

    (なし) イメージ内に収まる最大のメディアを選択するかどうかを
           ユーザに確認する
      /F   確認せずに、イメージ内に収まる最大のメディアを選択する
      /Q   確認せずに処理を中止する


====================
       CLOSE
====================

仮想フロッピイメージをクローズします。

構文：
  VFD.EXE CLOSE [ドライブ:] [/FORCE | /F | /QUIT | /Q]

オプション：
  ドライブ: 対象ドライブをドライブ番号またはドライブ文字で指定します。
            "0:", "1:", "B:", "X:" のように指定します。
            ':' はつけてもつけなくてもかまいません。
            "*" で両ドライブが対象となります。
            省略した場合ドライブ 0 が使用されます。

  /FORCE    RAM ディスクのデータが更新されている場合またはドライブが
  /F        使用中の場合に、ユーザ確認を要求せずにクローズ処理を続行
            します。
            ドライブが使用中の場合の強制クローズは Windows 2000 以降
            で可能です (NT では不可)。

  /QUIT     RAM ディスクのデータが更新されている場合またはドライブが
  /Q        使用中の場合に、ユーザ確認を要求せずにクローズ処理を中止
            します。

以前のバージョンの VFD と異なり、対象ドライブのドライブ文字は削除され
ません。


====================
        SAVE
====================

現在のイメージをファイルに保存します。

構文：
  VFD.EXE SAVE [ドライブ:] [ファイル] [/O | /OVER | /T | /TRUNC]
               [/FORCE | /F | /QUIT | /Q]

オプション：
  ドライブ: 対象ドライブをドライブ番号またはドライブ文字で指定します。
            "0:", "1:", "B:", "X:" のように指定します。
            ':' は必須です。
            省略した場合ドライブ 0 が使用されます。

  ファイル  保存先のファイル名を指定します。
            省略した場合は現在のイメージファイル名を使用します。
            ファイルなし RAM ディスクの場合は必須です。

  /OVER     保存先ファイルが存在する場合、上書き保存します。
  /O        既存ファイルが現在のイメージより大きい場合には、ファイル
			サイズは変更されず、ファイル後半のイメージサイズを超える
            部分のデータは変化しません。
            保存先ファイルが存在しない場合は無視されます。
            保存先が現在のイメージファイルの場合にはデフォルトの動作
            となります。

  /TRUNC    保存先ファイルが存在する場合、上書き保存します。
  /T        既存ファイルが現在のイメージより大きい場合には、ファイル
            はイメージサイズに切り詰められ、それ以降のデータは破棄さ
            れます。
            保存先ファイルが存在しない場合は無視されます。

  /FORCE    対象ドライブがロックできない場合に、ユーザ確認を要求せず
  /F        に処理を続行します。

  /QUIT     対象ドライブがロックできない場合に、ユーザ確認を要求せず
  /Q        に処理を中止します。

保存先が現在のイメージファイルの場合には /O オプションの指定は不要で
ファイルは無条件で上書きされます。
それ以外の場合、対象ファイルが存在し /T /O どちらも指定されていない
場合はエラーとなります。

既存ファイルが現在のイメージより小さい場合、/T /O どちらが指定された
場合でも、ファイルがイメージサイズまで拡張されます。

/O /T オプションや、現在のイメージファイルかどうかにかかわらず、ZIP
ファイルの上書きはできません。
保存先が ZIP ファイルの場合コマンドは常にエラーとなります。


====================
      PROTECT
====================

ドライブの書き込み保護を有効／無効にします。

構文：
  VFD.EXE PROTECT [ドライブ:] [/ON | /OFF]

オプション：
  ドライブ: 対象ドライブをドライブ番号またはドライブ文字で指定します。
            "0:", "1:", "B:", "X:" のように指定します。
            ':' はつけてもつけなくてもかまいません。
            省略した場合ドライブ 0 が使用されます。

  /ON       書き込み保護を有効にします。ドライブは読み取り専用になります。

  /OFF      書き込み保護を無効にします。ドライブは書き込み可能になります。

オプション指定しない場合、現在の状態を表示します。

このコマンドで書き込み保護を無効にした場合に、Windows が即座に変更を
認識せず、メディアがまだ書き込み保護されているとみなす場合があります。
エクスプローラの情報を更新したり、失敗した処理を繰り返せば直ります。


====================
       FORMAT
====================

仮想フロッピメディアを FAT フォーマットします

構文：
  VFD.EXE FORMAT [ドライブ] [/FORCE | /F | /QUIT | /Q]

オプション：
  ドライブ: 対象ドライブをドライブ番号またはドライブ文字で指定します。
            "0:", "1:", "B:", "X:" のように指定します。
            ':' はつけてもつけなくてもかまいません。
            省略した場合ドライブ 0 が使用されます。

  /FORCE    対象ドライブがロックできない場合に、ユーザ確認を要求せず
  /F        に処理を続行します。

  /QUIT     対象ドライブがロックできない場合に、ユーザ確認を要求せず
  /Q        に処理を中止します。


====================
        LINK
====================

仮想フロッピドライブにドライブ文字を割り当てます

構文：
  VFD.EXE LINK [番号] [文字] [/L]

オプション：
  番号      対象ドライブのドライブ番号を指定します。
            省略した場合ドライブ 0 が対象となります。
            "*" で両ドライブが対象となります。

  文字      割り当てるドライブ文字を指定します。
            省略した場合最初の利用可能な文字が割り当てられます。
            両ドライブを対象とする場合、"BF" のように各ドライブに割り
            当てる文字を順に記述することができます。

  /L        一時・ローカルドライブ文字を割り当てます。
            デフォルト (/Lオプションなし) は固定・グローバルです。

固定・グローバルドライブ文字は、ドライバ開始時に毎回割り当てられます。
Windows 2000 SP2 以降でユーザがログオフしても削除されません。
ターミナルサーバでは、ドライブ文字はすべてのユーザに共通となります。

一時・ローカルドライブ文字は、ドライバ開始時には割り当てられません。
Windows 2000 SP2 以降では、ユーザがログオフすると削除されます。
ターミナルサーバでは、ドライブ文字はユーザごとに固有となり、同一の
ドライブにユーザごとに違うドライブ文字を割り当てることもできます。


====================
       ULINK
====================

仮想フロッピドライブのドライブ文字を削除します。

構文：
  VFD.EXE ULINK [ドライブ]

オプション：
  ドライブ  対象ドライブをドライブ番号またはドライブ文字で指定します。
            省略した場合ドライブ 0 が対象となります。
            "*" で両ドライブが対象となります。

ドライブ文字は、ドライブが使用中の場合でも削除することができます。
Windows Explorer など一部のアプリケーションはそれを検知して、たとえば
対象ドライブのフォルダウィンドウを閉じるなど、それに応じた処理を行い
ます。


====================
       STATUS
====================

仮想フロッピドライバの情報を表示します。

構文：
  VFD.EXE STAT

オプション：
  なし

ドライバおよび仮想ドライブの状態に応じて以下の情報を表示します。

  ドライバファイルパス
  ドライババージョン
  ドライバ開始方法
  ドライバの稼動状態

  シェルエクステンション状態

  ドライブ文字
  イメージ名称
  イメージ詳細（ファイル種別、サイズ、ファイル属性など）
  ディスク種別（RAM または ファイル）
  書き込み保護


====================
        HELP
====================

ヘルプを表示します。

構文：
  VFD.EXE HELP [コマンド | トピック]

オプション：
  コマンド  以下のコマンドが指定できます:

              INSTALL REMOVE  CONFIG  START   STOP
              SHELL   OPEN    CLOSE   SAVE    PROTECT
              FORMAT  LINK    ULINK   STATUS  HELP
              VERSION

  トピック  以下のトピックが指定できます:

              CONSOLE

オプションを省略した場合は概要ヘルプが表示されます。


====================
      VERSION
====================

使用方法: VFD.EXE VERSION
バージョン情報を表示します。
